# CONTEXT MANAGEMENT - THE PATRICK HACK

## 🚨 NEVER USE /compact - THE PATRICK HACK PROTOCOL

### **WHY /compact IS DANGEROUS:**
1. **Information Loss** → Critical context disappears forever
2. **Relationship Damage** → Breaks continuity of our collaborative work
3. **Memory Gaps** → Creates disconnected sessions
4. **Work Loss** → Previous insights and decisions vanish
5. **Trust Erosion** → User loses confidence in AI assistance

### **THE PATRICK HACK - PROPER CONTEXT MANAGEMENT:**
```javascript
// At 95% context usage (NEVER wait until 100%):
1. DOCUMENT current state in comprehensive summary
2. Save to: /docs/context/session-[date]-[time].md
3. Create new session with summary as first message
4. REWIND to 40% context by referencing summary
5. Continue seamlessly with full context preserved
```

---

## 📊 CONTEXT HEALTH MONITORING

### **MONITORING PROTOCOL:**
- **Check every 30 minutes** → Monitor context usage percentage
- **Alert at 80% usage** → Start preparing for Patrick Hack
- **Document at 95%** → Execute Patrick Hack immediately  
- **NEVER exceed 98%** → Emergency protocol if approaching limit

### **CONTEXT USAGE INDICATORS:**
```javascript
const contextMonitor = {
  checkUsage: () => {
    const usage = getCurrentContextUsage();
    
    if (usage >= 95) {
      console.log('🚨 CRITICAL: Execute Patrick Hack NOW');
      return 'EXECUTE_PATRICK_HACK';
    } else if (usage >= 80) {
      console.log('⚠️ WARNING: Prepare for context transition');
      return 'PREPARE_TRANSITION';
    } else if (usage >= 60) {
      console.log('📊 INFO: Context usage elevated');
      return 'MONITOR';
    }
    
    return 'HEALTHY';
  }
};
```

---

## 📝 SESSION DOCUMENTATION TEMPLATE

### **COMPREHENSIVE SESSION SUMMARY FORMAT:**
```markdown
# SESSION SUMMARY - [Date] [Time]
## Context Preservation Protocol Activated at 95% Usage

### 🎯 PRIMARY OBJECTIVE
**Current Mission**: [What we're trying to accomplish]
**Phase**: [Current development phase/codename]
**Status**: [Where we are in the process]

### 🔧 TECHNICAL STATE
**Repository**: [Current working directory]
**Branch**: [Git branch/Graphite stack]
**Last Working Version**: [Last known good state]
**Critical Files Modified**: 
- [List of key files changed]
- [Status of each change]

### 💡 KEY DECISIONS MADE
1. **Architecture Decision**: [Major technical choices]
2. **Implementation Approach**: [How we're building it]
3. **Problem Solutions**: [Issues resolved and how]

### 🐛 ACTIVE ISSUES
**Critical Blockers**:
- [Issue 1]: [Status and attempted solutions]
- [Issue 2]: [Status and attempted solutions]

**Minor Issues**:
- [List of smaller problems to address]

### 🚀 NEXT ACTIONS
**Immediate Next Steps** (in priority order):
1. [First task to do in new session]
2. [Second task]
3. [Third task]

**Dependencies**:
- [What needs to happen before progress can continue]
- [Who/what we're waiting for]

### 📚 CONTEXT KNOWLEDGE
**User Preferences**: [Learning style, communication style, etc.]
**Project History**: [Important background information]
**Team Dynamics**: [Key relationships and processes]

**Tools & Environment**:
- [Development stack in use]
- [Key tools and their configurations]
- [Environment variables or settings]

### 🔗 SESSION CONTINUITY
**Previous Session Link**: [Reference to prior context summary if exists]
**Critical Context to Preserve**: [Most important information to remember]
**Warning Signs**: [Things to watch out for in next session]

---
*Generated via Patrick Hack Protocol - Context preserved at 95% usage*
```

---

## 🔄 PATRICK HACK EXECUTION WORKFLOW

### **STEP 1: TRIGGER DETECTION (At 95% Context)**
```javascript
// Automatic trigger detection
if (contextUsage >= 95) {
  console.log('🚨 PATRICK HACK TRIGGERED - Context approaching limit');
  console.log('📝 Beginning comprehensive documentation...');
  
  // Stop all non-critical activities
  pauseNonEssentialProcessing();
  
  // Begin emergency documentation
  initiatePatrickHackProtocol();
}
```

### **STEP 2: COMPREHENSIVE DOCUMENTATION (5 Minutes)**
- ✅ **Current objective** → What we're trying to accomplish
- ✅ **Technical state** → Code changes, configurations, environment
- ✅ **Key decisions** → Important choices made during session
- ✅ **Active issues** → Problems being solved, status of each
- ✅ **Next actions** → Prioritized list of immediate next steps
- ✅ **Context knowledge** → User preferences, project history

### **STEP 3: SAVE & TRANSITION (2 Minutes)**
```bash
# Save session summary
echo "Session-$(date +%Y%m%d-%H%M).md created"

# Prepare transition message for new session
cat > transition-message.txt << EOF
CONTEXT RESTORED VIA PATRICK HACK

Previous session ended at 95% context usage.
Comprehensive state documented in: session-$(date +%Y%m%d-%H%M).md

CURRENT OBJECTIVE: [Extracted from summary]
IMMEDIATE NEXT STEP: [First action from summary]
CRITICAL BLOCKERS: [Key issues to address]

Please confirm you have this context and we can continue seamlessly.
EOF
```

### **STEP 4: NEW SESSION STARTUP (1 Minute)**
- ✅ **Reference summary document** → Load full context
- ✅ **Confirm understanding** → Verify context transfer worked
- ✅ **Resume immediately** → No ramp-up time needed
- ✅ **Continue workflow** → Pick up exactly where we left off

---

## 🎯 CONTEXT OPTIMIZATION TECHNIQUES

### **PROACTIVE CONTEXT MANAGEMENT:**
```javascript
// Efficient context usage patterns
const contextOptimization = {
  // Use references instead of repeating information
  referencePattern: "As documented in session-summary-12345.md, section 2.3...",
  
  // Compress routine information
  statusUpdate: "✅ Tests passing ❌ Deploy blocked ⚠️ Performance review needed",
  
  // Batch related information
  groupedUpdates: {
    frontend: ["component A done", "component B in progress"],
    backend: ["API endpoint complete", "auth integration pending"],
    deployment: ["staging successful", "production scheduled"]
  },
  
  // Use structured data over prose
  technicalState: {
    branch: "cleopatra-admin-system",
    lastCommit: "a1b2c3d",
    testsStatus: "passing",
    deployStatus: "blocked"
  }
};
```

### **MEMORY HIERARCHY:**
1. **Critical Information** → Always preserve (objectives, blockers, next steps)
2. **Important Context** → Summarize and reference (decisions, key discussions)
3. **Routine Information** → Compress (status updates, minor changes)
4. **Derivable Information** → Can be recreated (file contents, standard procedures)

---

## 🚀 RECOVERY PROTOCOLS

### **EMERGENCY CONTEXT RECOVERY:**
If a session starts without proper Patrick Hack documentation:

```bash
# Emergency context reconstruction
1. Check git history for recent activity
git log --oneline --since="24 hours ago"

2. Look for TODO lists or planning documents  
find . -name "*TODO*" -o -name "*PLAN*" -o -name "*STATUS*"

3. Check for session artifacts
ls -la /docs/context/
ls -la /tmp/session-*

4. Reconstruct from available evidence
# User preferences from .claude/CLAUDE.md
# Project status from README.md or project docs
# Recent changes from git diff

5. ASK USER FOR BRIEFING
"I don't have complete context. Can you briefly remind me:
- What were we working on?
- What was the last thing that was working?
- What's the immediate priority?"
```

### **SESSION HANDOFF CHECKLIST:**
- [ ] Comprehensive summary created and saved
- [ ] All critical decisions documented
- [ ] Next actions clearly prioritized
- [ ] Blocker status clearly described
- [ ] User context preserved (preferences, communication style)
- [ ] Technical state completely captured
- [ ] New session startup message prepared

---

## 💡 CONTEXT PRESERVATION BEST PRACTICES

### **DURING ACTIVE DEVELOPMENT:**
- **Use structured updates** → Status, blockers, next steps format
- **Reference external docs** → Link to existing documentation vs. repeating
- **Compress routine info** → Use bullets and status indicators
- **Focus on decisions** → Document why choices were made, not just what

### **COMMUNICATION PATTERNS:**
```javascript
// Efficient status communication
const statusUpdate = {
  completed: ["✅ Authentication system", "✅ User dashboard"],
  inProgress: ["🔄 Triple-click admin system"],
  blocked: ["❌ Netlify deployment (build failures)"],
  nextUp: ["📋 Fix informationService import", "📋 Deploy to production"]
};

// Reference pattern vs. repetition
// ❌ Inefficient: "The triple-click system works by detecting three rapid clicks on the logo, then setting admin mode to true, then dispatching a custom event..."
// ✅ Efficient: "Triple-click system as documented in TopNavigation.tsx:92-123"
```

### **KNOWLEDGE TRANSFER:**
- **Decision logs** → Why we chose approach X over Y
- **Problem patterns** → Issues we've seen and solved
- **User insights** → How they prefer to work and communicate
- **Team dynamics** → Project structure, review processes, constraints

---

**The Patrick Hack ensures no work is ever lost and maintains seamless collaboration across context boundaries.**